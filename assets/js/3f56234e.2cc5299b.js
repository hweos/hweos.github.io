"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[9373],{8453:(n,e,d)=>{d.d(e,{R:()=>t,x:()=>E});var s=d(6540);const r={},i=s.createContext(r);function t(n){const e=s.useContext(i);return s.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function E(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:t(n.components),s.createElement(i.Provider,{value:e},n.children)}},8630:(n,e,d)=>{d.r(e),d.d(e,{assets:()=>l,contentTitle:()=>E,default:()=>N,frontMatter:()=>t,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"backend/database-design","title":"\u6570\u636e\u5e93\u8bbe\u8ba1\u57fa\u7840","description":"\u6570\u636e\u5e93\u8bbe\u8ba1\u662f\u540e\u7aef\u5f00\u53d1\u7684\u6838\u5fc3\u80fd\u529b\uff0c\u826f\u597d\u7684\u8bbe\u8ba1\u51b3\u5b9a\u4e86\u7cfb\u7edf\u7684\u6027\u80fd\u548c\u53ef\u7ef4\u62a4\u6027\u3002","source":"@site/docs/backend/database-design.md","sourceDirName":"backend","slug":"/backend/database-design","permalink":"/docs/backend/database-design","draft":false,"unlisted":false,"editUrl":"https://github.com/hweos/git-pages/edit/main/docs/backend/database-design.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"Backend","permalink":"/docs/category/backend"},"next":{"title":"Node.js \u5165\u95e8\u6307\u5357","permalink":"/docs/backend/nodejs-intro"}}');var r=d(4848),i=d(8453);const t={},E="\u6570\u636e\u5e93\u8bbe\u8ba1\u57fa\u7840",l={},a=[{value:"\u8bbe\u8ba1\u6d41\u7a0b",id:"\u8bbe\u8ba1\u6d41\u7a0b",level:2},{value:"\u8303\u5f0f\u7406\u8bba",id:"\u8303\u5f0f\u7406\u8bba",level:2},{value:"\u7b2c\u4e00\u8303\u5f0f (1NF)",id:"\u7b2c\u4e00\u8303\u5f0f-1nf",level:3},{value:"\u7b2c\u4e8c\u8303\u5f0f (2NF)",id:"\u7b2c\u4e8c\u8303\u5f0f-2nf",level:3},{value:"\u7b2c\u4e09\u8303\u5f0f (3NF)",id:"\u7b2c\u4e09\u8303\u5f0f-3nf",level:3},{value:"\u53cd\u8303\u5f0f\u5316",id:"\u53cd\u8303\u5f0f\u5316",level:3},{value:"\u8868\u7ed3\u6784\u8bbe\u8ba1",id:"\u8868\u7ed3\u6784\u8bbe\u8ba1",level:2},{value:"\u547d\u540d\u89c4\u8303",id:"\u547d\u540d\u89c4\u8303",level:3},{value:"\u901a\u7528\u5b57\u6bb5",id:"\u901a\u7528\u5b57\u6bb5",level:3},{value:"\u6570\u636e\u7c7b\u578b\u9009\u62e9",id:"\u6570\u636e\u7c7b\u578b\u9009\u62e9",level:3},{value:"\u5b57\u6bb5\u8bbe\u8ba1\u539f\u5219",id:"\u5b57\u6bb5\u8bbe\u8ba1\u539f\u5219",level:3},{value:"\u5173\u7cfb\u8bbe\u8ba1",id:"\u5173\u7cfb\u8bbe\u8ba1",level:2},{value:"\u4e00\u5bf9\u4e00 (1:1)",id:"\u4e00\u5bf9\u4e00-11",level:3},{value:"\u4e00\u5bf9\u591a (1)",id:"\u4e00\u5bf9\u591a-1",level:3},{value:"\u591a\u5bf9\u591a (M)",id:"\u591a\u5bf9\u591a-m",level:3},{value:"\u7d22\u5f15\u8bbe\u8ba1",id:"\u7d22\u5f15\u8bbe\u8ba1",level:2},{value:"\u7d22\u5f15\u7c7b\u578b",id:"\u7d22\u5f15\u7c7b\u578b",level:3},{value:"\u7d22\u5f15\u539f\u5219",id:"\u7d22\u5f15\u539f\u5219",level:3},{value:"\u7d22\u5f15\u5931\u6548\u573a\u666f",id:"\u7d22\u5f15\u5931\u6548\u573a\u666f",level:3},{value:"\u5b9e\u6218\u6848\u4f8b",id:"\u5b9e\u6218\u6848\u4f8b",level:2},{value:"\u7535\u5546\u8ba2\u5355\u7cfb\u7edf",id:"\u7535\u5546\u8ba2\u5355\u7cfb\u7edf",level:3},{value:"\u67e5\u8be2\u4f18\u5316\u793a\u4f8b",id:"\u67e5\u8be2\u4f18\u5316\u793a\u4f8b",level:3},{value:"\u5e38\u89c1\u95ee\u9898",id:"\u5e38\u89c1\u95ee\u9898",level:2},{value:"\u4e3b\u952e\u9009\u62e9",id:"\u4e3b\u952e\u9009\u62e9",level:3},{value:"\u8f6f\u5220\u9664",id:"\u8f6f\u5220\u9664",level:3},{value:"\u5927\u8868\u4f18\u5316",id:"\u5927\u8868\u4f18\u5316",level:3},{value:"\u603b\u7ed3",id:"\u603b\u7ed3",level:2}];function c(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,i.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.header,{children:(0,r.jsx)(e.h1,{id:"\u6570\u636e\u5e93\u8bbe\u8ba1\u57fa\u7840",children:"\u6570\u636e\u5e93\u8bbe\u8ba1\u57fa\u7840"})}),"\n",(0,r.jsx)(e.p,{children:"\u6570\u636e\u5e93\u8bbe\u8ba1\u662f\u540e\u7aef\u5f00\u53d1\u7684\u6838\u5fc3\u80fd\u529b\uff0c\u826f\u597d\u7684\u8bbe\u8ba1\u51b3\u5b9a\u4e86\u7cfb\u7edf\u7684\u6027\u80fd\u548c\u53ef\u7ef4\u62a4\u6027\u3002"}),"\n",(0,r.jsx)(e.h2,{id:"\u8bbe\u8ba1\u6d41\u7a0b",children:"\u8bbe\u8ba1\u6d41\u7a0b"}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u9700\u6c42\u5206\u6790"})," - \u7406\u89e3\u4e1a\u52a1\u9700\u6c42"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u6982\u5ff5\u8bbe\u8ba1"})," - \u7ed8\u5236 ER \u56fe"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u903b\u8f91\u8bbe\u8ba1"})," - \u8f6c\u6362\u4e3a\u8868\u7ed3\u6784"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u7269\u7406\u8bbe\u8ba1"})," - \u7d22\u5f15\u3001\u5206\u533a\u4f18\u5316"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\u5b9e\u65bd\u7ef4\u62a4"})," - \u5efa\u8868\u3001\u8fc1\u79fb\u3001\u4f18\u5316"]}),"\n"]}),"\n",(0,r.jsx)(e.h2,{id:"\u8303\u5f0f\u7406\u8bba",children:"\u8303\u5f0f\u7406\u8bba"}),"\n",(0,r.jsx)(e.h3,{id:"\u7b2c\u4e00\u8303\u5f0f-1nf",children:"\u7b2c\u4e00\u8303\u5f0f (1NF)"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\u6bcf\u5217\u90fd\u662f\u539f\u5b50\u6027\u7684\uff0c\u4e0d\u53ef\u518d\u5206\u3002"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"-- \u274c \u4e0d\u7b26\u5408 1NF\nCREATE TABLE orders (\n  id INT,\n  products VARCHAR(255)  -- '\u624b\u673a,\u7535\u8111,\u8033\u673a'\n);\n\n-- \u2705 \u7b26\u5408 1NF\nCREATE TABLE orders (\n  id INT PRIMARY KEY\n);\n\nCREATE TABLE order_items (\n  id INT PRIMARY KEY,\n  order_id INT,\n  product_id INT,\n  quantity INT\n);\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u7b2c\u4e8c\u8303\u5f0f-2nf",children:"\u7b2c\u4e8c\u8303\u5f0f (2NF)"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\u6ee1\u8db3 1NF\uff0c\u4e14\u975e\u4e3b\u952e\u5217\u5b8c\u5168\u4f9d\u8d56\u4e8e\u4e3b\u952e\uff08\u6d88\u9664\u90e8\u5206\u4f9d\u8d56\uff09\u3002"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"-- \u274c \u4e0d\u7b26\u5408 2NF\uff08\u590d\u5408\u4e3b\u952e\u573a\u666f\uff09\nCREATE TABLE order_items (\n  order_id INT,\n  product_id INT,\n  product_name VARCHAR(100),  -- \u53ea\u4f9d\u8d56 product_id\n  quantity INT,\n  PRIMARY KEY (order_id, product_id)\n);\n\n-- \u2705 \u7b26\u5408 2NF - \u62c6\u5206\nCREATE TABLE products (\n  id INT PRIMARY KEY,\n  name VARCHAR(100)\n);\n\nCREATE TABLE order_items (\n  order_id INT,\n  product_id INT,\n  quantity INT,\n  PRIMARY KEY (order_id, product_id)\n);\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u7b2c\u4e09\u8303\u5f0f-3nf",children:"\u7b2c\u4e09\u8303\u5f0f (3NF)"}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\u6ee1\u8db3 2NF\uff0c\u4e14\u975e\u4e3b\u952e\u5217\u4e4b\u95f4\u6ca1\u6709\u4f20\u9012\u4f9d\u8d56\u3002"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"-- \u274c \u4e0d\u7b26\u5408 3NF\nCREATE TABLE employees (\n  id INT PRIMARY KEY,\n  name VARCHAR(100),\n  dept_id INT,\n  dept_name VARCHAR(100),  -- \u4f9d\u8d56 dept_id\uff0c\u4e0d\u662f\u76f4\u63a5\u4f9d\u8d56\u4e3b\u952e\n  dept_location VARCHAR(100)\n);\n\n-- \u2705 \u7b26\u5408 3NF - \u62c6\u5206\nCREATE TABLE departments (\n  id INT PRIMARY KEY,\n  name VARCHAR(100),\n  location VARCHAR(100)\n);\n\nCREATE TABLE employees (\n  id INT PRIMARY KEY,\n  name VARCHAR(100),\n  dept_id INT,\n  FOREIGN KEY (dept_id) REFERENCES departments(id)\n);\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u53cd\u8303\u5f0f\u5316",children:"\u53cd\u8303\u5f0f\u5316"}),"\n",(0,r.jsx)(e.p,{children:"\u6709\u65f6\u4e3a\u4e86\u6027\u80fd\uff0c\u9002\u5f53\u8fdd\u53cd\u8303\u5f0f\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"-- \u5197\u4f59\u5b57\u6bb5\uff0c\u907f\u514d JOIN\nCREATE TABLE orders (\n  id INT PRIMARY KEY,\n  user_id INT,\n  user_name VARCHAR(100),  -- \u5197\u4f59\uff0c\u4fbf\u4e8e\u67e5\u8be2\n  total_amount DECIMAL(10, 2),\n  created_at TIMESTAMP\n);\n"})}),"\n",(0,r.jsx)(e.h2,{id:"\u8868\u7ed3\u6784\u8bbe\u8ba1",children:"\u8868\u7ed3\u6784\u8bbe\u8ba1"}),"\n",(0,r.jsx)(e.h3,{id:"\u547d\u540d\u89c4\u8303",children:"\u547d\u540d\u89c4\u8303"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"-- \u8868\u540d\uff1a\u5c0f\u5199\u4e0b\u5212\u7ebf\uff0c\u590d\u6570\u5f62\u5f0f\nusers, order_items, user_addresses\n\n-- \u5b57\u6bb5\u540d\uff1a\u5c0f\u5199\u4e0b\u5212\u7ebf\nuser_id, created_at, is_deleted\n\n-- \u7d22\u5f15\u540d\uff1aidx_\u8868\u540d_\u5b57\u6bb5\u540d\nidx_users_email, idx_orders_user_id_created_at\n\n-- \u5916\u952e\u540d\uff1afk_\u5f53\u524d\u8868_\u5173\u8054\u8868\nfk_orders_users\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u901a\u7528\u5b57\u6bb5",children:"\u901a\u7528\u5b57\u6bb5"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"CREATE TABLE users (\n  -- \u4e3b\u952e\n  id BIGINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,\n  \n  -- \u4e1a\u52a1\u5b57\u6bb5\n  name VARCHAR(100) NOT NULL,\n  email VARCHAR(255) NOT NULL,\n  \n  -- \u72b6\u6001\u5b57\u6bb5\n  status TINYINT DEFAULT 1 COMMENT '1:\u6b63\u5e38 0:\u7981\u7528',\n  \n  -- \u8f6f\u5220\u9664\n  is_deleted TINYINT DEFAULT 0,\n  deleted_at TIMESTAMP NULL,\n  \n  -- \u65f6\u95f4\u6233\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n  \n  -- \u7d22\u5f15\n  UNIQUE KEY uk_email (email),\n  KEY idx_status (status),\n  KEY idx_created_at (created_at)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u6570\u636e\u7c7b\u578b\u9009\u62e9",children:"\u6570\u636e\u7c7b\u578b\u9009\u62e9"}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"\u7c7b\u578b"}),(0,r.jsx)(e.th,{children:"\u573a\u666f"}),(0,r.jsx)(e.th,{children:"\u8bf4\u660e"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"BIGINT"}),(0,r.jsx)(e.td,{children:"\u4e3b\u952e\u3001ID"}),(0,r.jsx)(e.td,{children:"8 \u5b57\u8282\uff0c\u63a8\u8350\u65e0\u7b26\u53f7"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"INT"}),(0,r.jsx)(e.td,{children:"\u6570\u91cf\u3001\u8ba1\u6570"}),(0,r.jsx)(e.td,{children:"4 \u5b57\u8282"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"TINYINT"}),(0,r.jsx)(e.td,{children:"\u72b6\u6001\u3001\u5e03\u5c14"}),(0,r.jsx)(e.td,{children:"1 \u5b57\u8282\uff0c0-255"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"DECIMAL(M,D)"}),(0,r.jsx)(e.td,{children:"\u91d1\u989d"}),(0,r.jsx)(e.td,{children:"\u7cbe\u786e\u8ba1\u7b97"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"VARCHAR(N)"}),(0,r.jsx)(e.td,{children:"\u53d8\u957f\u5b57\u7b26\u4e32"}),(0,r.jsx)(e.td,{children:"N \u4e3a\u6700\u5927\u5b57\u7b26\u6570"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"TEXT"}),(0,r.jsx)(e.td,{children:"\u957f\u6587\u672c"}),(0,r.jsx)(e.td,{children:"\u4e0d\u53c2\u4e0e\u7d22\u5f15"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"TIMESTAMP"}),(0,r.jsx)(e.td,{children:"\u65f6\u95f4"}),(0,r.jsx)(e.td,{children:"4 \u5b57\u8282\uff0c\u81ea\u52a8\u65f6\u533a\u8f6c\u6362"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"DATETIME"}),(0,r.jsx)(e.td,{children:"\u65f6\u95f4"}),(0,r.jsx)(e.td,{children:"8 \u5b57\u8282\uff0c\u539f\u6837\u5b58\u50a8"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"JSON"}),(0,r.jsx)(e.td,{children:"JSON \u6570\u636e"}),(0,r.jsx)(e.td,{children:"MySQL 5.7+"})]})]})]}),"\n",(0,r.jsx)(e.h3,{id:"\u5b57\u6bb5\u8bbe\u8ba1\u539f\u5219",children:"\u5b57\u6bb5\u8bbe\u8ba1\u539f\u5219"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"-- 1. \u5b57\u6bb5\u5c3d\u91cf NOT NULL\nname VARCHAR(100) NOT NULL DEFAULT ''\n\n-- 2. \u4f7f\u7528\u5408\u9002\u7684\u957f\u5ea6\nphone VARCHAR(20)      -- \u4e0d\u8981 VARCHAR(255)\nstatus TINYINT         -- \u4e0d\u8981 INT\n\n-- 3. \u91d1\u989d\u4f7f\u7528 DECIMAL\nprice DECIMAL(10, 2)   -- \u4e0d\u8981 FLOAT/DOUBLE\n\n-- 4. \u65f6\u95f4\u7528 TIMESTAMP \u6216 DATETIME\ncreated_at TIMESTAMP   -- \u6709\u65f6\u533a\u9700\u6c42\nbirth_date DATE        -- \u7eaf\u65e5\u671f\n\n-- 5. \u5e03\u5c14\u7528 TINYINT\nis_active TINYINT(1) DEFAULT 1\n\n-- 6. \u679a\u4e3e\u8003\u8651\u7528 TINYINT + \u6ce8\u91ca\nstatus TINYINT COMMENT '1:\u5f85\u652f\u4ed8 2:\u5df2\u652f\u4ed8 3:\u5df2\u53d1\u8d27 4:\u5df2\u5b8c\u6210 5:\u5df2\u53d6\u6d88'\n"})}),"\n",(0,r.jsx)(e.h2,{id:"\u5173\u7cfb\u8bbe\u8ba1",children:"\u5173\u7cfb\u8bbe\u8ba1"}),"\n",(0,r.jsx)(e.h3,{id:"\u4e00\u5bf9\u4e00-11",children:"\u4e00\u5bf9\u4e00 (1:1)"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"-- \u7528\u6237\u8868\nCREATE TABLE users (\n  id BIGINT PRIMARY KEY,\n  username VARCHAR(50) NOT NULL\n);\n\n-- \u7528\u6237\u8be6\u60c5\u8868\uff08\u62c6\u5206\u5927\u5b57\u6bb5\uff09\nCREATE TABLE user_profiles (\n  user_id BIGINT PRIMARY KEY,\n  bio TEXT,\n  avatar_url VARCHAR(500),\n  FOREIGN KEY (user_id) REFERENCES users(id)\n);\n"})}),"\n",(0,r.jsxs)(e.h3,{id:"\u4e00\u5bf9\u591a-1",children:["\u4e00\u5bf9\u591a (1",":N",")"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"-- \u7528\u6237\u8868\nCREATE TABLE users (\n  id BIGINT PRIMARY KEY,\n  name VARCHAR(100)\n);\n\n-- \u8ba2\u5355\u8868\nCREATE TABLE orders (\n  id BIGINT PRIMARY KEY,\n  user_id BIGINT NOT NULL,\n  total_amount DECIMAL(10, 2),\n  FOREIGN KEY (user_id) REFERENCES users(id),\n  KEY idx_user_id (user_id)\n);\n"})}),"\n",(0,r.jsxs)(e.h3,{id:"\u591a\u5bf9\u591a-m",children:["\u591a\u5bf9\u591a (M",":N",")"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"-- \u7528\u6237\u8868\nCREATE TABLE users (\n  id BIGINT PRIMARY KEY,\n  name VARCHAR(100)\n);\n\n-- \u89d2\u8272\u8868\nCREATE TABLE roles (\n  id BIGINT PRIMARY KEY,\n  name VARCHAR(50)\n);\n\n-- \u5173\u8054\u8868\nCREATE TABLE user_roles (\n  user_id BIGINT,\n  role_id BIGINT,\n  assigned_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  PRIMARY KEY (user_id, role_id),\n  FOREIGN KEY (user_id) REFERENCES users(id),\n  FOREIGN KEY (role_id) REFERENCES roles(id)\n);\n"})}),"\n",(0,r.jsx)(e.h2,{id:"\u7d22\u5f15\u8bbe\u8ba1",children:"\u7d22\u5f15\u8bbe\u8ba1"}),"\n",(0,r.jsx)(e.h3,{id:"\u7d22\u5f15\u7c7b\u578b",children:"\u7d22\u5f15\u7c7b\u578b"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"-- \u4e3b\u952e\u7d22\u5f15\nPRIMARY KEY (id)\n\n-- \u552f\u4e00\u7d22\u5f15\nUNIQUE KEY uk_email (email)\n\n-- \u666e\u901a\u7d22\u5f15\nKEY idx_name (name)\n\n-- \u590d\u5408\u7d22\u5f15\nKEY idx_user_created (user_id, created_at)\n\n-- \u524d\u7f00\u7d22\u5f15\nKEY idx_title (title(20))\n\n-- \u5168\u6587\u7d22\u5f15\nFULLTEXT KEY ft_content (content)\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u7d22\u5f15\u539f\u5219",children:"\u7d22\u5f15\u539f\u5219"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"-- 1. \u4e3a WHERE/ORDER BY/JOIN \u7684\u5b57\u6bb5\u5efa\u7d22\u5f15\nSELECT * FROM orders WHERE user_id = 1 ORDER BY created_at;\n-- \u9700\u8981\u7d22\u5f15: (user_id, created_at)\n\n-- 2. \u590d\u5408\u7d22\u5f15\u6ce8\u610f\u987a\u5e8f\uff08\u6700\u5de6\u524d\u7f00\uff09\nKEY idx_a_b_c (a, b, c)\n-- \u53ef\u7528: WHERE a=1, WHERE a=1 AND b=2, WHERE a=1 AND b=2 AND c=3\n-- \u4e0d\u53ef\u7528: WHERE b=2, WHERE c=3\n\n-- 3. \u9009\u62e9\u6027\u9ad8\u7684\u5b57\u6bb5\u4f18\u5148\n-- email \u9009\u62e9\u6027\u9ad8\uff0cstatus \u9009\u62e9\u6027\u4f4e\nKEY idx_email_status (email, status)  -- \u2705\nKEY idx_status_email (status, email)  -- \u274c\n\n-- 4. \u8986\u76d6\u7d22\u5f15\nSELECT user_id, created_at FROM orders WHERE user_id = 1;\nKEY idx_user_created (user_id, created_at)\n-- \u53ef\u76f4\u63a5\u4ece\u7d22\u5f15\u83b7\u53d6\u6570\u636e\uff0c\u65e0\u9700\u56de\u8868\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u7d22\u5f15\u5931\u6548\u573a\u666f",children:"\u7d22\u5f15\u5931\u6548\u573a\u666f"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"-- 1. \u51fd\u6570\u64cd\u4f5c\n\u274c WHERE YEAR(created_at) = 2024\n\u2705 WHERE created_at >= '2024-01-01' AND created_at < '2025-01-01'\n\n-- 2. \u9690\u5f0f\u7c7b\u578b\u8f6c\u6362\n\u274c WHERE phone = 13800138000  -- phone \u662f VARCHAR\n\u2705 WHERE phone = '13800138000'\n\n-- 3. \u524d\u5bfc\u6a21\u7cca\u67e5\u8be2\n\u274c WHERE name LIKE '%tom%'\n\u2705 WHERE name LIKE 'tom%'\n\n-- 4. OR \u6761\u4ef6\uff08\u90e8\u5206\uff09\n\u274c WHERE user_id = 1 OR status = 1  -- \u5982\u679c status \u6ca1\u7d22\u5f15\n\u2705 WHERE user_id = 1 \n   UNION\n   WHERE status = 1\n\n-- 5. NOT IN / NOT EXISTS\n\u274c WHERE status NOT IN (1, 2)\n\u2705 WHERE status IN (0, 3, 4, 5)\n\n-- 6. \u8303\u56f4\u67e5\u8be2\u540e\u7684\u5217\nidx_a_b_c (a, b, c)\nWHERE a = 1 AND b > 10 AND c = 100  -- c \u7528\u4e0d\u5230\u7d22\u5f15\n"})}),"\n",(0,r.jsx)(e.h2,{id:"\u5b9e\u6218\u6848\u4f8b",children:"\u5b9e\u6218\u6848\u4f8b"}),"\n",(0,r.jsx)(e.h3,{id:"\u7535\u5546\u8ba2\u5355\u7cfb\u7edf",children:"\u7535\u5546\u8ba2\u5355\u7cfb\u7edf"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"-- \u7528\u6237\u8868\nCREATE TABLE users (\n  id BIGINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,\n  username VARCHAR(50) NOT NULL,\n  email VARCHAR(255) NOT NULL,\n  password_hash VARCHAR(255) NOT NULL,\n  phone VARCHAR(20),\n  status TINYINT DEFAULT 1,\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n  UNIQUE KEY uk_email (email),\n  UNIQUE KEY uk_username (username),\n  KEY idx_phone (phone)\n) ENGINE=InnoDB;\n\n-- \u6536\u8d27\u5730\u5740\nCREATE TABLE user_addresses (\n  id BIGINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,\n  user_id BIGINT UNSIGNED NOT NULL,\n  receiver_name VARCHAR(50) NOT NULL,\n  phone VARCHAR(20) NOT NULL,\n  province VARCHAR(50),\n  city VARCHAR(50),\n  district VARCHAR(50),\n  address VARCHAR(255) NOT NULL,\n  is_default TINYINT DEFAULT 0,\n  KEY idx_user_id (user_id)\n) ENGINE=InnoDB;\n\n-- \u5546\u54c1\u5206\u7c7b\nCREATE TABLE categories (\n  id INT UNSIGNED AUTO_INCREMENT PRIMARY KEY,\n  parent_id INT UNSIGNED DEFAULT 0,\n  name VARCHAR(100) NOT NULL,\n  level TINYINT NOT NULL,\n  sort_order INT DEFAULT 0,\n  KEY idx_parent (parent_id)\n) ENGINE=InnoDB;\n\n-- \u5546\u54c1\nCREATE TABLE products (\n  id BIGINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,\n  category_id INT UNSIGNED NOT NULL,\n  name VARCHAR(255) NOT NULL,\n  description TEXT,\n  price DECIMAL(10, 2) NOT NULL,\n  stock INT UNSIGNED DEFAULT 0,\n  status TINYINT DEFAULT 1,\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  KEY idx_category (category_id),\n  KEY idx_status_created (status, created_at)\n) ENGINE=InnoDB;\n\n-- \u8ba2\u5355\nCREATE TABLE orders (\n  id BIGINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,\n  order_no VARCHAR(32) NOT NULL,\n  user_id BIGINT UNSIGNED NOT NULL,\n  status TINYINT DEFAULT 1 COMMENT '1:\u5f85\u652f\u4ed8 2:\u5df2\u652f\u4ed8 3:\u5df2\u53d1\u8d27 4:\u5df2\u5b8c\u6210 5:\u5df2\u53d6\u6d88',\n  total_amount DECIMAL(10, 2) NOT NULL,\n  pay_amount DECIMAL(10, 2),\n  receiver_name VARCHAR(50),\n  receiver_phone VARCHAR(20),\n  receiver_address VARCHAR(500),\n  pay_time TIMESTAMP NULL,\n  ship_time TIMESTAMP NULL,\n  complete_time TIMESTAMP NULL,\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  UNIQUE KEY uk_order_no (order_no),\n  KEY idx_user_status (user_id, status),\n  KEY idx_created_at (created_at)\n) ENGINE=InnoDB;\n\n-- \u8ba2\u5355\u9879\nCREATE TABLE order_items (\n  id BIGINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,\n  order_id BIGINT UNSIGNED NOT NULL,\n  product_id BIGINT UNSIGNED NOT NULL,\n  product_name VARCHAR(255) NOT NULL,\n  product_price DECIMAL(10, 2) NOT NULL,\n  quantity INT UNSIGNED NOT NULL,\n  KEY idx_order (order_id),\n  KEY idx_product (product_id)\n) ENGINE=InnoDB;\n\n-- \u652f\u4ed8\u8bb0\u5f55\nCREATE TABLE payments (\n  id BIGINT UNSIGNED AUTO_INCREMENT PRIMARY KEY,\n  order_id BIGINT UNSIGNED NOT NULL,\n  payment_no VARCHAR(64),\n  channel VARCHAR(20) COMMENT 'alipay/wechat/card',\n  amount DECIMAL(10, 2) NOT NULL,\n  status TINYINT DEFAULT 0 COMMENT '0:\u5f85\u652f\u4ed8 1:\u6210\u529f 2:\u5931\u8d25',\n  paid_at TIMESTAMP NULL,\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  KEY idx_order (order_id),\n  UNIQUE KEY uk_payment_no (payment_no)\n) ENGINE=InnoDB;\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u67e5\u8be2\u4f18\u5316\u793a\u4f8b",children:"\u67e5\u8be2\u4f18\u5316\u793a\u4f8b"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"-- \u7528\u6237\u8ba2\u5355\u5217\u8868\uff08\u5e26\u5206\u9875\uff09\nSELECT \n  o.id,\n  o.order_no,\n  o.status,\n  o.total_amount,\n  o.created_at,\n  COUNT(oi.id) as item_count\nFROM orders o\nLEFT JOIN order_items oi ON o.id = oi.order_id\nWHERE o.user_id = 123\nGROUP BY o.id\nORDER BY o.created_at DESC\nLIMIT 10 OFFSET 0;\n\n-- \u9700\u8981\u7d22\u5f15: orders(user_id, created_at), order_items(order_id)\n\n-- \u9500\u91cf\u6392\u884c\nSELECT \n  p.id,\n  p.name,\n  SUM(oi.quantity) as total_sold\nFROM products p\nJOIN order_items oi ON p.id = oi.product_id\nJOIN orders o ON oi.order_id = o.id\nWHERE o.status IN (2, 3, 4)  -- \u5df2\u652f\u4ed8\u53ca\u4e4b\u540e\u72b6\u6001\n  AND o.created_at >= DATE_SUB(NOW(), INTERVAL 30 DAY)\nGROUP BY p.id\nORDER BY total_sold DESC\nLIMIT 10;\n"})}),"\n",(0,r.jsx)(e.h2,{id:"\u5e38\u89c1\u95ee\u9898",children:"\u5e38\u89c1\u95ee\u9898"}),"\n",(0,r.jsx)(e.h3,{id:"\u4e3b\u952e\u9009\u62e9",children:"\u4e3b\u952e\u9009\u62e9"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"-- \u81ea\u589e\u4e3b\u952e\uff08\u63a8\u8350\uff09\nid BIGINT UNSIGNED AUTO_INCREMENT PRIMARY KEY\n\n-- UUID\uff08\u5206\u5e03\u5f0f\u573a\u666f\uff09\nid CHAR(36) PRIMARY KEY\n-- \u6216\u4f7f\u7528\u6709\u5e8f UUID\nid BINARY(16) PRIMARY KEY\n\n-- \u96ea\u82b1\u7b97\u6cd5\uff08\u5206\u5e03\u5f0f\u6709\u5e8f\uff09\nid BIGINT PRIMARY KEY\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u8f6f\u5220\u9664",children:"\u8f6f\u5220\u9664"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"-- \u65b9\u6848 1: \u6807\u8bb0\u5b57\u6bb5\nis_deleted TINYINT DEFAULT 0\ndeleted_at TIMESTAMP NULL\n\n-- \u65b9\u6848 2: \u72b6\u6001\u5b57\u6bb5\nstatus TINYINT COMMENT '...-1:\u5df2\u5220\u9664'\n\n-- \u67e5\u8be2\u65f6\u8fc7\u6ee4\nSELECT * FROM users WHERE is_deleted = 0;\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u5927\u8868\u4f18\u5316",children:"\u5927\u8868\u4f18\u5316"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-sql",children:"-- \u5206\u8868\uff08\u6309\u65f6\u95f4\uff09\norders_2024_01, orders_2024_02, ...\n\n-- \u5206\u8868\uff08\u6309 ID \u53d6\u6a21\uff09\norders_0, orders_1, orders_2, orders_3\n\n-- \u5f52\u6863\u5386\u53f2\u6570\u636e\nINSERT INTO orders_archive SELECT * FROM orders WHERE created_at < '2023-01-01';\nDELETE FROM orders WHERE created_at < '2023-01-01';\n"})}),"\n",(0,r.jsx)(e.h2,{id:"\u603b\u7ed3",children:"\u603b\u7ed3"}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"\u539f\u5219"}),(0,r.jsx)(e.th,{children:"\u8bf4\u660e"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\u9002\u5ea6\u8303\u5f0f\u5316"}),(0,r.jsx)(e.td,{children:"\u901a\u5e38\u9075\u5faa 3NF\uff0c\u9002\u5f53\u53cd\u8303\u5f0f"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\u5408\u9002\u7684\u7c7b\u578b"}),(0,r.jsx)(e.td,{children:"\u9009\u62e9\u6700\u5c0f\u6ee1\u8db3\u9700\u6c42\u7684\u7c7b\u578b"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"NOT NULL"}),(0,r.jsx)(e.td,{children:"\u5c3d\u91cf\u907f\u514d NULL"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\u7d22\u5f15\u4f18\u5316"}),(0,r.jsx)(e.td,{children:"\u9488\u5bf9\u67e5\u8be2\u5efa\u7acb\u5408\u9002\u7d22\u5f15"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\u5206\u8868\u7b56\u7565"}),(0,r.jsx)(e.td,{children:"\u5927\u8868\u63d0\u524d\u89c4\u5212\u5206\u8868\u65b9\u6848"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\u8f6f\u5220\u9664"}),(0,r.jsx)(e.td,{children:"\u91cd\u8981\u6570\u636e\u4e0d\u7269\u7406\u5220\u9664"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\u5ba1\u8ba1\u5b57\u6bb5"}),(0,r.jsx)(e.td,{children:"created_at, updated_at"})]})]})]})]})}function N(n={}){const{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(c,{...n})}):c(n)}}}]);