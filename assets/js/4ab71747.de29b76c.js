"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[7575],{4173:(n,e,s)=>{s.r(e),s.d(e,{assets:()=>o,contentTitle:()=>d,default:()=>p,frontMatter:()=>t,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"frontend/vite-guide","title":"Vite \u914d\u7f6e\u6307\u5357","description":"Vite \u662f\u4e0b\u4e00\u4ee3\u524d\u7aef\u6784\u5efa\u5de5\u5177\uff0c\u5f00\u53d1\u4f53\u9a8c\u6781\u4f73\uff0c\u6784\u5efa\u901f\u5ea6\u98de\u5feb\u3002","source":"@site/docs/frontend/vite-guide.md","sourceDirName":"frontend","slug":"/frontend/vite-guide","permalink":"/docs/frontend/vite-guide","draft":false,"unlisted":false,"editUrl":"https://github.com/hweos/git-pages/edit/main/docs/frontend/vite-guide.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"React \u7ec4\u4ef6\u8bbe\u8ba1\u6a21\u5f0f","permalink":"/docs/frontend/react-patterns"},"next":{"title":"Weekly Report","permalink":"/docs/category/weekly-report"}}');var r=s(4848),l=s(8453);const t={},d="Vite \u914d\u7f6e\u6307\u5357",o={},c=[{value:"\u5feb\u901f\u5f00\u59cb",id:"\u5feb\u901f\u5f00\u59cb",level:2},{value:"\u53ef\u7528\u6a21\u677f",id:"\u53ef\u7528\u6a21\u677f",level:3},{value:"\u57fa\u7840\u914d\u7f6e",id:"\u57fa\u7840\u914d\u7f6e",level:2},{value:"vite.config.ts",id:"viteconfigts",level:3},{value:"tsconfig.json \u914d\u5408\u522b\u540d",id:"tsconfigjson-\u914d\u5408\u522b\u540d",level:3},{value:"\u5f00\u53d1\u670d\u52a1\u5668",id:"\u5f00\u53d1\u670d\u52a1\u5668",level:2},{value:"\u4ee3\u7406\u914d\u7f6e",id:"\u4ee3\u7406\u914d\u7f6e",level:3},{value:"HTTPS \u914d\u7f6e",id:"https-\u914d\u7f6e",level:3},{value:"\u6784\u5efa\u4f18\u5316",id:"\u6784\u5efa\u4f18\u5316",level:2},{value:"\u4ee3\u7801\u5206\u5272",id:"\u4ee3\u7801\u5206\u5272",level:3},{value:"\u538b\u7f29\u914d\u7f6e",id:"\u538b\u7f29\u914d\u7f6e",level:3},{value:"\u5206\u6790\u6253\u5305\u4f53\u79ef",id:"\u5206\u6790\u6253\u5305\u4f53\u79ef",level:3},{value:"\u73af\u5883\u53d8\u91cf",id:"\u73af\u5883\u53d8\u91cf",level:2},{value:".env \u6587\u4ef6",id:"env-\u6587\u4ef6",level:3},{value:"\u4f7f\u7528\u73af\u5883\u53d8\u91cf",id:"\u4f7f\u7528\u73af\u5883\u53d8\u91cf",level:3},{value:"TypeScript \u7c7b\u578b\u5b9a\u4e49",id:"typescript-\u7c7b\u578b\u5b9a\u4e49",level:3},{value:"\u5e38\u7528\u63d2\u4ef6",id:"\u5e38\u7528\u63d2\u4ef6",level:2},{value:"\u81ea\u52a8\u5bfc\u5165",id:"\u81ea\u52a8\u5bfc\u5165",level:3},{value:"SVG \u7ec4\u4ef6",id:"svg-\u7ec4\u4ef6",level:3},{value:"PWA \u652f\u6301",id:"pwa-\u652f\u6301",level:3},{value:"CSS \u914d\u7f6e",id:"css-\u914d\u7f6e",level:2},{value:"CSS Modules",id:"css-modules",level:3},{value:"\u9884\u5904\u7406\u5668",id:"\u9884\u5904\u7406\u5668",level:3},{value:"PostCSS",id:"postcss",level:3},{value:"\u9759\u6001\u8d44\u6e90\u5904\u7406",id:"\u9759\u6001\u8d44\u6e90\u5904\u7406",level:2},{value:"\u8d44\u6e90\u5bfc\u5165",id:"\u8d44\u6e90\u5bfc\u5165",level:3},{value:"public \u76ee\u5f55",id:"public-\u76ee\u5f55",level:3},{value:"\u8d44\u6e90\u5185\u8054",id:"\u8d44\u6e90\u5185\u8054",level:3},{value:"\u591a\u9875\u5e94\u7528",id:"\u591a\u9875\u5e94\u7528",level:2},{value:"\u5e93\u6a21\u5f0f",id:"\u5e93\u6a21\u5f0f",level:2},{value:"\u5b8c\u6574\u914d\u7f6e\u793a\u4f8b",id:"\u5b8c\u6574\u914d\u7f6e\u793a\u4f8b",level:2},{value:"\u5e38\u89c1\u95ee\u9898",id:"\u5e38\u89c1\u95ee\u9898",level:2},{value:"\u522b\u540d\u4e0d\u751f\u6548",id:"\u522b\u540d\u4e0d\u751f\u6548",level:3},{value:"HMR \u4e0d\u5de5\u4f5c",id:"hmr-\u4e0d\u5de5\u4f5c",level:3},{value:"\u4f9d\u8d56\u4f18\u5316",id:"\u4f9d\u8d56\u4f18\u5316",level:3},{value:"\u603b\u7ed3",id:"\u603b\u7ed3",level:2}];function a(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,l.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.header,{children:(0,r.jsx)(e.h1,{id:"vite-\u914d\u7f6e\u6307\u5357",children:"Vite \u914d\u7f6e\u6307\u5357"})}),"\n",(0,r.jsx)(e.p,{children:"Vite \u662f\u4e0b\u4e00\u4ee3\u524d\u7aef\u6784\u5efa\u5de5\u5177\uff0c\u5f00\u53d1\u4f53\u9a8c\u6781\u4f73\uff0c\u6784\u5efa\u901f\u5ea6\u98de\u5feb\u3002"}),"\n",(0,r.jsx)(e.h2,{id:"\u5feb\u901f\u5f00\u59cb",children:"\u5feb\u901f\u5f00\u59cb"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# \u521b\u5efa\u9879\u76ee\nnpm create vite@latest my-app -- --template react-ts\n\n# \u8fdb\u5165\u9879\u76ee\ncd my-app\n\n# \u5b89\u88c5\u4f9d\u8d56\nnpm install\n\n# \u542f\u52a8\u5f00\u53d1\u670d\u52a1\u5668\nnpm run dev\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u53ef\u7528\u6a21\u677f",children:"\u53ef\u7528\u6a21\u677f"}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"\u6a21\u677f"}),(0,r.jsx)(e.th,{children:"\u547d\u4ee4"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"React + TS"}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"--template react-ts"})})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"React + JS"}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"--template react"})})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"Vue + TS"}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"--template vue-ts"})})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"Vanilla + TS"}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"--template vanilla-ts"})})]})]})]}),"\n",(0,r.jsx)(e.h2,{id:"\u57fa\u7840\u914d\u7f6e",children:"\u57fa\u7840\u914d\u7f6e"}),"\n",(0,r.jsx)(e.h3,{id:"viteconfigts",children:"vite.config.ts"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-typescript",children:"import { defineConfig } from 'vite';\nimport react from '@vitejs/plugin-react';\nimport path from 'path';\n\nexport default defineConfig({\n  plugins: [react()],\n  \n  // \u5f00\u53d1\u670d\u52a1\u5668\u914d\u7f6e\n  server: {\n    port: 3000,\n    open: true, // \u81ea\u52a8\u6253\u5f00\u6d4f\u89c8\u5668\n    host: true, // \u76d1\u542c\u6240\u6709\u5730\u5740\n  },\n  \n  // \u6784\u5efa\u914d\u7f6e\n  build: {\n    outDir: 'dist',\n    sourcemap: true,\n  },\n  \n  // \u8def\u5f84\u522b\u540d\n  resolve: {\n    alias: {\n      '@': path.resolve(__dirname, './src'),\n      '@components': path.resolve(__dirname, './src/components'),\n      '@hooks': path.resolve(__dirname, './src/hooks'),\n      '@utils': path.resolve(__dirname, './src/utils'),\n    },\n  },\n});\n"})}),"\n",(0,r.jsx)(e.h3,{id:"tsconfigjson-\u914d\u5408\u522b\u540d",children:"tsconfig.json \u914d\u5408\u522b\u540d"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-json",children:'{\n  "compilerOptions": {\n    "baseUrl": ".",\n    "paths": {\n      "@/*": ["src/*"],\n      "@components/*": ["src/components/*"],\n      "@hooks/*": ["src/hooks/*"],\n      "@utils/*": ["src/utils/*"]\n    }\n  }\n}\n'})}),"\n",(0,r.jsx)(e.h2,{id:"\u5f00\u53d1\u670d\u52a1\u5668",children:"\u5f00\u53d1\u670d\u52a1\u5668"}),"\n",(0,r.jsx)(e.h3,{id:"\u4ee3\u7406\u914d\u7f6e",children:"\u4ee3\u7406\u914d\u7f6e"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-typescript",children:"export default defineConfig({\n  server: {\n    proxy: {\n      // \u5b57\u7b26\u4e32\u7b80\u5199\n      '/foo': 'http://localhost:4567',\n      \n      // \u5b8c\u6574\u914d\u7f6e\n      '/api': {\n        target: 'http://localhost:8080',\n        changeOrigin: true,\n        rewrite: (path) => path.replace(/^\\/api/, ''),\n      },\n      \n      // WebSocket \u4ee3\u7406\n      '/socket.io': {\n        target: 'ws://localhost:5174',\n        ws: true,\n      },\n    },\n  },\n});\n"})}),"\n",(0,r.jsx)(e.h3,{id:"https-\u914d\u7f6e",children:"HTTPS \u914d\u7f6e"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-typescript",children:"import fs from 'fs';\n\nexport default defineConfig({\n  server: {\n    https: {\n      key: fs.readFileSync('keys/localhost-key.pem'),\n      cert: fs.readFileSync('keys/localhost.pem'),\n    },\n  },\n});\n\n// \u6216\u4f7f\u7528 @vitejs/plugin-basic-ssl \u5feb\u901f\u542f\u7528\nimport basicSsl from '@vitejs/plugin-basic-ssl';\n\nexport default defineConfig({\n  plugins: [basicSsl()],\n});\n"})}),"\n",(0,r.jsx)(e.h2,{id:"\u6784\u5efa\u4f18\u5316",children:"\u6784\u5efa\u4f18\u5316"}),"\n",(0,r.jsx)(e.h3,{id:"\u4ee3\u7801\u5206\u5272",children:"\u4ee3\u7801\u5206\u5272"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-typescript",children:"export default defineConfig({\n  build: {\n    rollupOptions: {\n      output: {\n        // \u5206\u5272\u7b2c\u4e09\u65b9\u5e93\n        manualChunks: {\n          vendor: ['react', 'react-dom'],\n          router: ['react-router-dom'],\n          ui: ['@radix-ui/react-dialog', '@radix-ui/react-dropdown-menu'],\n        },\n        \n        // \u6216\u4f7f\u7528\u51fd\u6570\u52a8\u6001\u5206\u5272\n        manualChunks(id) {\n          if (id.includes('node_modules')) {\n            if (id.includes('react')) {\n              return 'react-vendor';\n            }\n            if (id.includes('lodash')) {\n              return 'lodash';\n            }\n            return 'vendor';\n          }\n        },\n      },\n    },\n  },\n});\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u538b\u7f29\u914d\u7f6e",children:"\u538b\u7f29\u914d\u7f6e"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-typescript",children:"import viteCompression from 'vite-plugin-compression';\n\nexport default defineConfig({\n  plugins: [\n    viteCompression({\n      algorithm: 'gzip',\n      ext: '.gz',\n    }),\n    viteCompression({\n      algorithm: 'brotliCompress',\n      ext: '.br',\n    }),\n  ],\n  \n  build: {\n    // \u542f\u7528 CSS \u4ee3\u7801\u5206\u5272\n    cssCodeSplit: true,\n    \n    // \u538b\u7f29\u9009\u9879\n    minify: 'terser',\n    terserOptions: {\n      compress: {\n        drop_console: true,\n        drop_debugger: true,\n      },\n    },\n  },\n});\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u5206\u6790\u6253\u5305\u4f53\u79ef",children:"\u5206\u6790\u6253\u5305\u4f53\u79ef"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"npm install rollup-plugin-visualizer -D\n"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-typescript",children:"import { visualizer } from 'rollup-plugin-visualizer';\n\nexport default defineConfig({\n  plugins: [\n    visualizer({\n      open: true,\n      filename: 'stats.html',\n      gzipSize: true,\n    }),\n  ],\n});\n"})}),"\n",(0,r.jsx)(e.h2,{id:"\u73af\u5883\u53d8\u91cf",children:"\u73af\u5883\u53d8\u91cf"}),"\n",(0,r.jsx)(e.h3,{id:"env-\u6587\u4ef6",children:".env \u6587\u4ef6"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# .env - \u6240\u6709\u73af\u5883\nVITE_APP_TITLE=My App\n\n# .env.development - \u5f00\u53d1\u73af\u5883\nVITE_API_URL=http://localhost:8080\n\n# .env.production - \u751f\u4ea7\u73af\u5883\nVITE_API_URL=https://api.example.com\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u4f7f\u7528\u73af\u5883\u53d8\u91cf",children:"\u4f7f\u7528\u73af\u5883\u53d8\u91cf"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-typescript",children:"// \u5728\u4ee3\u7801\u4e2d\u8bbf\u95ee\nconsole.log(import.meta.env.VITE_API_URL);\nconsole.log(import.meta.env.VITE_APP_TITLE);\n\n// \u5185\u7f6e\u53d8\u91cf\nconsole.log(import.meta.env.MODE);     // 'development' | 'production'\nconsole.log(import.meta.env.DEV);      // true | false\nconsole.log(import.meta.env.PROD);     // true | false\nconsole.log(import.meta.env.BASE_URL); // base \u8def\u5f84\n"})}),"\n",(0,r.jsx)(e.h3,{id:"typescript-\u7c7b\u578b\u5b9a\u4e49",children:"TypeScript \u7c7b\u578b\u5b9a\u4e49"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-typescript",children:'// src/vite-env.d.ts\n/// <reference types="vite/client" />\n\ninterface ImportMetaEnv {\n  readonly VITE_API_URL: string;\n  readonly VITE_APP_TITLE: string;\n}\n\ninterface ImportMeta {\n  readonly env: ImportMetaEnv;\n}\n'})}),"\n",(0,r.jsx)(e.h2,{id:"\u5e38\u7528\u63d2\u4ef6",children:"\u5e38\u7528\u63d2\u4ef6"}),"\n",(0,r.jsx)(e.h3,{id:"\u81ea\u52a8\u5bfc\u5165",children:"\u81ea\u52a8\u5bfc\u5165"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"npm install unplugin-auto-import unplugin-react-components -D\n"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-typescript",children:"import AutoImport from 'unplugin-auto-import/vite';\nimport Components from 'unplugin-react-components/vite';\n\nexport default defineConfig({\n  plugins: [\n    AutoImport({\n      imports: ['react', 'react-router-dom'],\n      dts: 'src/auto-imports.d.ts',\n    }),\n    Components({\n      dirs: ['src/components'],\n      dts: 'src/components.d.ts',\n    }),\n  ],\n});\n"})}),"\n",(0,r.jsx)(e.h3,{id:"svg-\u7ec4\u4ef6",children:"SVG \u7ec4\u4ef6"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"npm install vite-plugin-svgr -D\n"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-typescript",children:"import svgr from 'vite-plugin-svgr';\n\nexport default defineConfig({\n  plugins: [\n    svgr({\n      svgrOptions: {\n        icon: true,\n      },\n    }),\n  ],\n});\n\n// \u4f7f\u7528\nimport Logo from './logo.svg?react';\n\nfunction App() {\n  return <Logo className=\"logo\" />;\n}\n"})}),"\n",(0,r.jsx)(e.h3,{id:"pwa-\u652f\u6301",children:"PWA \u652f\u6301"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"npm install vite-plugin-pwa -D\n"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-typescript",children:"import { VitePWA } from 'vite-plugin-pwa';\n\nexport default defineConfig({\n  plugins: [\n    VitePWA({\n      registerType: 'autoUpdate',\n      manifest: {\n        name: 'My App',\n        short_name: 'App',\n        theme_color: '#ffffff',\n        icons: [\n          {\n            src: '/icon-192.png',\n            sizes: '192x192',\n            type: 'image/png',\n          },\n          {\n            src: '/icon-512.png',\n            sizes: '512x512',\n            type: 'image/png',\n          },\n        ],\n      },\n    }),\n  ],\n});\n"})}),"\n",(0,r.jsx)(e.h2,{id:"css-\u914d\u7f6e",children:"CSS \u914d\u7f6e"}),"\n",(0,r.jsx)(e.h3,{id:"css-modules",children:"CSS Modules"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-typescript",children:"// \u9ed8\u8ba4\u652f\u6301\uff0c\u6587\u4ef6\u540d\u4ee5 .module.css \u7ed3\u5c3e\u5373\u53ef\n// Button.module.css\n\nexport default defineConfig({\n  css: {\n    modules: {\n      localsConvention: 'camelCase', // \u7c7b\u540d\u8f6c\u9a7c\u5cf0\n      generateScopedName: '[name]__[local]___[hash:base64:5]',\n    },\n  },\n});\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\u9884\u5904\u7406\u5668",children:"\u9884\u5904\u7406\u5668"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# \u5b89\u88c5\u9700\u8981\u7684\u9884\u5904\u7406\u5668\nnpm install sass -D\nnpm install less -D\nnpm install stylus -D\n"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-typescript",children:'export default defineConfig({\n  css: {\n    preprocessorOptions: {\n      scss: {\n        additionalData: `@import "@/styles/variables.scss";`,\n      },\n      less: {\n        javascriptEnabled: true,\n        additionalData: `@import "@/styles/variables.less";`,\n      },\n    },\n  },\n});\n'})}),"\n",(0,r.jsx)(e.h3,{id:"postcss",children:"PostCSS"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-typescript",children:"// postcss.config.js\nexport default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n};\n"})}),"\n",(0,r.jsx)(e.h2,{id:"\u9759\u6001\u8d44\u6e90\u5904\u7406",children:"\u9759\u6001\u8d44\u6e90\u5904\u7406"}),"\n",(0,r.jsx)(e.h3,{id:"\u8d44\u6e90\u5bfc\u5165",children:"\u8d44\u6e90\u5bfc\u5165"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-typescript",children:"// URL \u5bfc\u5165\nimport imgUrl from './img.png';\ndocument.getElementById('img').src = imgUrl;\n\n// \u539f\u59cb\u5185\u5bb9\u5bfc\u5165\nimport shaderCode from './shader.glsl?raw';\n\n// Web Worker\nimport Worker from './worker.js?worker';\nconst worker = new Worker();\n\n// JSON\nimport data from './data.json';\n"})}),"\n",(0,r.jsx)(e.h3,{id:"public-\u76ee\u5f55",children:"public \u76ee\u5f55"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"public/\n  favicon.ico\n  robots.txt\n  images/\n    logo.png\n"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-html",children:'\x3c!-- \u76f4\u63a5\u5f15\u7528\uff0c\u4e0d\u4f1a\u88ab\u5904\u7406 --\x3e\n<img src="/images/logo.png" alt="logo" />\n'})}),"\n",(0,r.jsx)(e.h3,{id:"\u8d44\u6e90\u5185\u8054",children:"\u8d44\u6e90\u5185\u8054"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-typescript",children:"export default defineConfig({\n  build: {\n    assetsInlineLimit: 4096, // 4KB \u4ee5\u4e0b\u7684\u8d44\u6e90\u5185\u8054\u4e3a base64\n  },\n});\n"})}),"\n",(0,r.jsx)(e.h2,{id:"\u591a\u9875\u5e94\u7528",children:"\u591a\u9875\u5e94\u7528"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-typescript",children:"import { resolve } from 'path';\n\nexport default defineConfig({\n  build: {\n    rollupOptions: {\n      input: {\n        main: resolve(__dirname, 'index.html'),\n        admin: resolve(__dirname, 'admin/index.html'),\n        login: resolve(__dirname, 'login/index.html'),\n      },\n    },\n  },\n});\n"})}),"\n",(0,r.jsx)(e.h2,{id:"\u5e93\u6a21\u5f0f",children:"\u5e93\u6a21\u5f0f"}),"\n",(0,r.jsx)(e.p,{children:"\u6784\u5efa\u53ef\u53d1\u5e03\u7684\u5e93\uff1a"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-typescript",children:"import { resolve } from 'path';\nimport dts from 'vite-plugin-dts';\n\nexport default defineConfig({\n  plugins: [dts()],\n  \n  build: {\n    lib: {\n      entry: resolve(__dirname, 'src/index.ts'),\n      name: 'MyLib',\n      fileName: (format) => `my-lib.${format}.js`,\n    },\n    rollupOptions: {\n      // \u5916\u90e8\u5316\u4f9d\u8d56\n      external: ['react', 'react-dom'],\n      output: {\n        globals: {\n          react: 'React',\n          'react-dom': 'ReactDOM',\n        },\n      },\n    },\n  },\n});\n"})}),"\n",(0,r.jsx)(e.h2,{id:"\u5b8c\u6574\u914d\u7f6e\u793a\u4f8b",children:"\u5b8c\u6574\u914d\u7f6e\u793a\u4f8b"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-typescript",children:"import { defineConfig, loadEnv } from 'vite';\nimport react from '@vitejs/plugin-react';\nimport path from 'path';\nimport { visualizer } from 'rollup-plugin-visualizer';\nimport viteCompression from 'vite-plugin-compression';\n\nexport default defineConfig(({ mode }) => {\n  const env = loadEnv(mode, process.cwd());\n  const isProd = mode === 'production';\n  \n  return {\n    plugins: [\n      react(),\n      isProd && viteCompression({ algorithm: 'gzip' }),\n      isProd && visualizer({ open: false, filename: 'stats.html' }),\n    ].filter(Boolean),\n    \n    resolve: {\n      alias: {\n        '@': path.resolve(__dirname, './src'),\n      },\n    },\n    \n    server: {\n      port: 3000,\n      open: true,\n      proxy: {\n        '/api': {\n          target: env.VITE_API_URL,\n          changeOrigin: true,\n          rewrite: (path) => path.replace(/^\\/api/, ''),\n        },\n      },\n    },\n    \n    build: {\n      outDir: 'dist',\n      sourcemap: !isProd,\n      minify: isProd ? 'terser' : false,\n      terserOptions: isProd ? {\n        compress: {\n          drop_console: true,\n          drop_debugger: true,\n        },\n      } : undefined,\n      rollupOptions: {\n        output: {\n          manualChunks: {\n            vendor: ['react', 'react-dom', 'react-router-dom'],\n          },\n        },\n      },\n    },\n    \n    css: {\n      modules: {\n        localsConvention: 'camelCase',\n      },\n      preprocessorOptions: {\n        scss: {\n          additionalData: `@import \"@/styles/variables.scss\";`,\n        },\n      },\n    },\n  };\n});\n"})}),"\n",(0,r.jsx)(e.h2,{id:"\u5e38\u89c1\u95ee\u9898",children:"\u5e38\u89c1\u95ee\u9898"}),"\n",(0,r.jsx)(e.h3,{id:"\u522b\u540d\u4e0d\u751f\u6548",children:"\u522b\u540d\u4e0d\u751f\u6548"}),"\n",(0,r.jsxs)(e.p,{children:["\u786e\u4fdd ",(0,r.jsx)(e.code,{children:"vite.config.ts"})," \u548c ",(0,r.jsx)(e.code,{children:"tsconfig.json"})," \u90fd\u914d\u7f6e\u4e86\u76f8\u540c\u7684\u522b\u540d\u3002"]}),"\n",(0,r.jsx)(e.h3,{id:"hmr-\u4e0d\u5de5\u4f5c",children:"HMR \u4e0d\u5de5\u4f5c"}),"\n",(0,r.jsxs)(e.p,{children:["\u68c0\u67e5\u7ec4\u4ef6\u662f\u5426\u6b63\u786e\u5bfc\u51fa\uff0cReact \u7ec4\u4ef6\u9700\u8981\u5177\u540d\u5bfc\u51fa\u6216\u4f7f\u7528 ",(0,r.jsx)(e.code,{children:"React.memo"})," \u5305\u88f9\u3002"]}),"\n",(0,r.jsx)(e.h3,{id:"\u4f9d\u8d56\u4f18\u5316",children:"\u4f9d\u8d56\u4f18\u5316"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-typescript",children:"export default defineConfig({\n  optimizeDeps: {\n    include: ['lodash-es'], // \u9884\u6784\u5efa\n    exclude: ['some-lib'],  // \u6392\u9664\u9884\u6784\u5efa\n  },\n});\n"})}),"\n",(0,r.jsx)(e.h2,{id:"\u603b\u7ed3",children:"\u603b\u7ed3"}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"\u914d\u7f6e\u9879"}),(0,r.jsx)(e.th,{children:"\u8bf4\u660e"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"plugins"})}),(0,r.jsx)(e.td,{children:"\u63d2\u4ef6\u914d\u7f6e"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"resolve.alias"})}),(0,r.jsx)(e.td,{children:"\u8def\u5f84\u522b\u540d"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"server"})}),(0,r.jsx)(e.td,{children:"\u5f00\u53d1\u670d\u52a1\u5668\u914d\u7f6e"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"build"})}),(0,r.jsx)(e.td,{children:"\u6784\u5efa\u914d\u7f6e"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"css"})}),(0,r.jsx)(e.td,{children:"CSS \u76f8\u5173\u914d\u7f6e"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"optimizeDeps"})}),(0,r.jsx)(e.td,{children:"\u4f9d\u8d56\u4f18\u5316\u914d\u7f6e"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"envPrefix"})}),(0,r.jsx)(e.td,{children:"\u73af\u5883\u53d8\u91cf\u524d\u7f00\uff08\u9ed8\u8ba4 VITE_\uff09"})]})]})]})]})}function p(n={}){const{wrapper:e}={...(0,l.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(a,{...n})}):a(n)}},8453:(n,e,s)=>{s.d(e,{R:()=>t,x:()=>d});var i=s(6540);const r={},l=i.createContext(r);function t(n){const e=i.useContext(l);return i.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function d(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:t(n.components),i.createElement(l.Provider,{value:e},n.children)}}}]);